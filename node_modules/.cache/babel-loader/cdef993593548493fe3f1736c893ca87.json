{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ludagladushina/react-apps/react-learning-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ludagladushina/react-apps/react-learning-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/ludagladushina/react-apps/react-learning-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{stopSubmit}from'redux-form';import{authAPI}from'../api/api';var SET_USER_DATA='samurai-network/auth/SET_USER_DATA';var initialState={userId:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),action.payload);default:return state;}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var getAuthUserData=function getAuthUserData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,userId,_response$data$data,email,_login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.me();case 2:response=_context.sent;if(response.data.resultCode===0){userId=response.data.data.id;_response$data$data=response.data.data,email=_response$data$data.email,_login=_response$data$data.login;dispatch(setAuthUserData(userId,email,_login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getAuthUserData());}else{message=response.data.messages.length>0?response.data.messages[0]:'SomeError';dispatch(stopSubmit('login',{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["/Users/ludagladushina/react-apps/react-learning-1/src/redux/auth-reducer.js"],"names":["stopSubmit","authAPI","SET_USER_DATA","initialState","userId","email","login","isAuth","authReducer","state","action","type","payload","setAuthUserData","getAuthUserData","dispatch","me","response","data","resultCode","id","password","rememberMe","message","messages","length","_error","logout"],"mappings":"ofAAA,OAASA,UAAT,KAA2B,YAA3B,CACA,OAASC,OAAT,KAAwB,YAAxB,CAEA,GAAMC,CAAAA,aAAa,CAAG,oCAAtB,CAGA,GAAIC,CAAAA,YAAY,CAAG,CACfC,MAAM,CAAE,IADO,CAEfC,KAAK,CAAE,IAFQ,CAGfC,KAAK,CAAE,IAHQ,CAIfC,MAAM,CAAE,KAJO,CAAnB,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CAElD,OAAOA,MAAM,CAACC,IAAd,EACI,IAAKT,CAAAA,aAAL,CACI,sCACOO,KADP,EAEMC,MAAM,CAACE,OAFb,EAKJ,QACI,MAAOH,CAAAA,KAAP,CARR,CAWH,CAbD,CAeA,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBC,MAAvB,QAAmC,CAAEI,IAAI,CAAET,aAAR,CAAuBU,OAAO,CACxF,CAAER,MAAM,CAANA,MAAF,CAAUC,KAAK,CAALA,KAAV,CAAiBC,KAAK,CAALA,KAAjB,CAAwBC,MAAM,CAANA,MAAxB,CAD0D,CAAnC,EAAxB,CAGP,MAAO,IAAMO,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,kGAAM,iBAAOC,QAAP,6LACZd,CAAAA,OAAO,CAACe,EAAR,EADY,QAC7BC,QAD6B,eAEjC,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAoC,CAC5Bf,MAD4B,CACnBa,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBE,EADA,qBAETH,QAAQ,CAACC,IAAT,CAAcA,IAFL,CAE1Bb,KAF0B,qBAE1BA,KAF0B,CAEnBC,MAFmB,qBAEnBA,KAFmB,CAGhCS,QAAQ,CAACF,eAAe,CAACT,MAAD,CAASC,KAAT,CAAgBC,MAAhB,CAAuB,IAAvB,CAAhB,CAAR,CACH,CANgC,sDAAN,gEAAxB,CASP,MAAO,IAAMA,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACD,KAAD,CAAQgB,QAAR,CAAkBC,UAAlB,kGAAiC,kBAAOP,QAAP,kKAC7Bd,CAAAA,OAAO,CAACK,KAAR,CAAcD,KAAd,CAAqBgB,QAArB,CAA+BC,UAA/B,CAD6B,QAC9CL,QAD8C,gBAElD,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAoC,CAChCJ,QAAQ,CAACD,eAAe,EAAhB,CAAR,CACH,CAFD,IAEO,CACCS,OADD,CACWN,QAAQ,CAACC,IAAT,CAAcM,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCR,QAAQ,CAACC,IAAT,CAAcM,QAAd,CAAuB,CAAvB,CAApC,CAAgE,WAD3E,CAEHT,QAAQ,CAACf,UAAU,CAAC,OAAD,CAAU,CAAE0B,MAAM,CAAEH,OAAV,CAAV,CAAX,CAAR,CACH,CAPiD,wDAAjC,kEAAd,CAUP,MAAO,IAAMI,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,mGAAM,kBAAOZ,QAAP,0JACHd,CAAAA,OAAO,CAAC0B,MAAR,EADG,QACpBV,QADoB,gBAExB,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAoC,CAChCJ,QAAQ,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAR,CACH,CAJuB,wDAAN,kEAAf,CAOP,cAAeL,CAAAA,WAAf","sourcesContent":["import { stopSubmit } from 'redux-form';\nimport { authAPI } from '../api/api';\n\nconst SET_USER_DATA = 'samurai-network/auth/SET_USER_DATA';\n \n\nlet initialState = {\n    userId: null,\n    email: null,\n    login: null,\n    isAuth: false\n}\n\nconst authReducer = (state = initialState, action) => {\n\n    switch(action.type) {\n        case SET_USER_DATA:\n            return {\n                ...state,\n               ...action.payload\n            }\n\n        default: \n            return state;\n\n    }\n}\n\nexport const setAuthUserData = (userId, email, login, isAuth) => ({ type: SET_USER_DATA, payload: \n        { userId, email, login, isAuth } });\n\nexport const getAuthUserData = () => async (dispatch) => {\n    let response = await authAPI.me();\n    if (response.data.resultCode === 0) {\n        let userId = response.data.data.id;\n        let { email, login } = response.data.data;\n        dispatch(setAuthUserData(userId, email, login, true));\n    }\n}\n\nexport const login = (email, password, rememberMe) => async (dispatch) => {\n    let response = await authAPI.login(email, password, rememberMe);\n    if (response.data.resultCode === 0) {\n        dispatch(getAuthUserData())\n    } else {\n        let message = response.data.messages.length > 0 ? response.data.messages[0] : 'SomeError';\n        dispatch(stopSubmit('login', { _error: message }));\n    }\n}\n\nexport const logout = () => async (dispatch) => {\n    let response = await authAPI.logout();\n    if (response.data.resultCode === 0) {\n        dispatch(setAuthUserData(null, null, null, false));\n    }\n}\n\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}